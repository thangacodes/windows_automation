name: PowerShell Script Execution on Windows Runner
on:
  workflow_dispatch
jobs:
  run-powershell-script:
    runs-on: windows-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Set up PowerShell
        uses: actions/setup-powershell@v1
      - name: Run PowerShell Script
        run: |
            write-host "PowerShell script invoked and is being executed..."
            try {
              .\windows_automation\data_type_finding.ps1
            }
            catch {
              write-host "An error occurred: $_"
              exit 1  # Ensure the job fails on error
            }
        shell: pwsh  # Use PowerShell Core (pwsh)
